---
layout: post
title: 【初中級者向け】VS Code で HSP3 開発環境を構築しよう！
date: 2025-12-15 23:55:18 +09:00
author: Velgail
tags: [HSP3, 入門, VS Code, 環境構築]
summary: 公式エディタ hsed3 からステップアップしたい人向けに、VS Code と HSP3 Language Support を使った開発環境の構築方法と、そのメリットを徹底解説します。
---

HSP3 での開発、普段は標準のエディタ（hsed3）を使っている方が多いと思います。 シンプルで使いやすい反面、コードが長くなってくると「もっと便利に書きたい！」「過去の状態に戻したい！」と思うことはありませんか？
この記事では、世界で最も使われているエディタ **Visual Studio Code (VS Code)** で HSP3 を開発する方法を紹介します。

## 1\. なぜ VS Code なのか？

公式エディタがあるのに、なぜわざわざ VS Code を使うのでしょうか？ 主な理由は以下の5つです。

### 1.1 強力な入力補完 (IntelliSense)

VS Code 最大の魅力は、コードを書きながらリアルタイムで補完候補が出る **IntelliSense** です。

* **hsed3**: コマンドを覚えていないと書けない。ヘルプを手動で開く必要がある。
* **VS Code**: `mes` と打てば候補が出現。パラメータの意味もその場で表示されます。

コマンドを丸暗記していなくても、サクサクとコードを書くことができます。

### 1.2 Git によるバージョン管理

「昨日のコードに戻したい」「間違って消してしまった」 そんな時、VS Code なら標準搭載の **Git** 機能で解決できます。

* 変更履歴を自動で記録
* 過去のバージョンにいつでも戻せる
* どこを変更したかが色付きで分かる

### 1.3 マルチカーソルによる効率化

変数名を一括で変えたい時、一つずつ書き換えていませんか？ VS Code なら `Ctrl+D` で同じ単語を複数選択し、**一瞬でまとめて編集**できます。

### 1.4 豊富な拡張機能

HSP 以外にも、便利な機能を追加できます。

* **Error Lens**: エラー内容をコードの行末に直接表示
* **Bracket Pair Colorizer**: 対応するカッコを色分けして見やすく
* **GitLens**: 誰がいつその行を書いたかを表示

### 1.5 他言語への応用

VS Code は Python, JavaScript, C++ など、あらゆる言語で使われています。 HSP で VS Code の使い方を覚えておけば、他の言語を学ぶ際にもそのままスキルが活かせます。

## 2\. 公式エディタ hsed3 との比較

「じゃあ hsed3 はもう使わなくていいの？」というと、そうではありません。 それぞれの得意分野があります。

| 機能 | hsed3 (公式) | VS Code + 拡張機能 |
| --- | ---------- | -------------- |
| **起動速度** | 🚀 爆速 | 🐢 やや遅い |
| **準備・設定** | 不要 (同梱) | 必要 (インストール等) |
| **入力補完** | △ (F1ヘルプ) | ◎ (リアルタイム補完) |
| **定義へ移動** | △ (ラベル一覧) | ◎ (F12でジャンプ) |
| **参照検索** | ❌ | ◎ (使用箇所を一覧表示) |
| **Git 連携** | ❌ | ◎ |
| **かんたん入力** | ◎ (AHT対応) | △ (スニペットで代用) |
| **文字コード** | Shift\_JIS | UTF-8 推奨 |

### どちらを選ぶべき？

* **hsed3 がおすすめ**:
    * プログラミングを始めたばかりの初心者
    * ちょっとしたテストコードを書きたい時
    * HSP の学習だけに集中したい時
* **VS Code がおすすめ**:
    * 数百行以上のプログラムを書く時
    * 他言語の経験がある、または学びたい時
    * Git でバージョン管理をしたい時
    * 入力補完で楽をしたい時

## 3\. セットアップガイド

それでは、実際に VS Code で HSP3 の開発環境を作ってみましょう。

### Step 1: 必要なもののインストール

1. **HSP3 (Ver3.7以上推奨)**
    * 公式サイトからダウンロードしてインストールしてください。
    * UTF-8 版のランタイムが含まれるバージョンを推奨します。
2. **Visual Studio Code**
    * [公式サイト](https://code.visualstudio.com/) からダウンロードしてインストールしてください。

### Step 2: 拡張機能「HSP3 Language Support」の導入

現在はプレビュー版のため、GitHub から拡張機能ファイル (`.vsix`) をダウンロードして手動でインストールします。

1. **拡張機能ファイルのダウンロード**
    * [GitHub Releases ページ](https://github.com/Velgail/HSP3-Language-Support/releases/tag/Initial-Release) にアクセスします。
    * **`hsp3-language-support-0.1.1.vsix`** をクリックしてダウンロードしてください。
2. **VS Code へのインストール**
    * VS Code を起動し、左側のバーにある **拡張機能アイコン** (四角いブロックのアイコン) をクリックします（または `Ctrl+Shift+X`）。
    * 拡張機能パネルの右上にある **「…」（ビューとその他のアクション）** をクリックします。
    * メニューから **「VSIX からインストール... (Install from VSIX...)」** を選択します。
    * 先ほどダウンロードした `.vsix` ファイルを選択してインストールします。

右下に「Completed installing HSP3 Language Support」と表示されれば導入完了です！

### Step 3: 設定 (settings.json)

拡張機能が HSP3 のインストール場所を認識できるように設定します。

1. `Ctrl + ,` (カンマ) を押して設定を開きます。
2. 検索ボックスに `hsp3` と入力します。
3. **Hsp3: Install Path** の項目に、HSP3 をインストールしたフォルダのパスを入力します。
    * 例: `C:\hsp37`

基本的にはこれで完了です！

## 4\. HSP3 Language Support の機能紹介

導入が完了すると、以下の機能が使えるようになります。

### シンタックスハイライト

命令、関数、文字列、コメントなどが色分けされて表示されます。 VS Code の拡張機能では、ドキュメントコメント（`/** ... */`）内の `@param` や `@return` もハイライトされます。(HSP3言語の特性の限界もあるようです……)
<img width="100%" alt="image" src="https://github.com/user-attachments/assets/7eb9b14b-120e-4194-b4a0-5d4a3b80afcb" />

### 入力補完 (IntelliSense)

* **キーワード補完**: `rep` → `repeat` のように命令を補完。(一部)
* **パラメータヒント**: カーソル位置のパラメータが何を意味するか（例：`p1: 表示する文字列`）を表示。
<img width="100%" alt="inline help" src="https://github.com/user-attachments/assets/5f3daadf-90c5-4e9d-9560-736cbb382712" />

* **ヘルプ連携**: HSP 付属のヘルプファイル (`.hs`) を解析し、標準命令の説明を表示します。
<img width="100%" alt="help_article" src="https://github.com/user-attachments/assets/72e52343-a234-41c1-9e29-35bfb3485182" />


### 定義へ移動 (F12)

自作の `#deffunc` や `#define`、ラベル `*label` を使っている場所で `F12` を押すと、その定義元へジャンプできます。 「この関数、どこで作ったっけ？」と探す手間がなくなります。

### 参照検索 (Shift + F12)

逆に、「この変数はどこで使われているか？」を一覧表示できます。

### コードスニペット

よく使う構文はテンプレートとして登録されています。 例えば `repeat` と入力して Tab キーを押すと、以下のように展開されます。

```hsp
repeat 10
    ; カーソル位置
loop
```

### コンパイル・実行 (F5)

hsed3 と同様に、`F5` キーでスクリプトを実行できます。 コンパイルエラーが発生した場合は、「問題」パネルにエラー箇所が表示され、クリックするだけで該当行にジャンプできます。

## 5\. よくある質問 \(FAQ\)

### Q. コンパイルエラーが出ます

**A.** 以下を確認してください。

1. 設定の `hsp3.installPath` は正しいですか？ (`hsp3.exe` があるフォルダを指定)
2. `hspcmp.dll` が HSP3 フォルダに存在しますか？

### Q. 文字化けします

**A.** VS Code はデフォルトで **UTF-8** を使用します。 一方、従来の HSP (hsed3) は **Shift\_JIS** です。

* 新規作成する場合は、VS Code の右下にある文字コード表示をクリックし、「エンコーディング付きで保存」→「UTF-8」を選択して保存することをお勧めします。
* HSP3.7 以降では UTF-8 でのコンパイルがサポートされています。
* Shift\_JIS の過去資産を扱う場合は、右下の文字コードから「Reopen with Encoding (エンコーディング付きで再度開く)」→「Shift\_JIS」を選択してください。

※ 参考: [UTF-8版エディタ hsed3u8 の紹介]({{ '/2025/12/11/introduce-hsed3u8.html' | relative_url }})

### Q. 補完が出ません

**A.** ファイルの拡張子が `.hsp` になっているか確認してください。 また、HSP3 のインストールフォルダにヘルプファイル (`hsphelp` フォルダ) があるか確認してください。

### Q. ここのFAQ全部試したけど駄目なんだけど？
**A.** ごめんなさい。多分バグですので、お気軽にこのページのDiscussionまたはHSP掲示板で報告ください。ここのDiscussionの場合 @Velgail でメンションすると気づきやすいかも？

## 6\. まとめ

**HSP3 Language Support** を導入した VS Code は、HSP3 の手軽さを残しつつ、現代的な開発体験を提供してくれます。

* まずは **hsed3** で基本を学ぶ。
* 慣れてきたら **VS Code** に移行して、Git や補完機能を活用する。

このステップアップが、HSP3 プログラミングをより楽しく、快適にしてくれるはずです。 ぜひ一度試してみてください！
